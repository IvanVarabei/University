unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TForm1 = class(TForm)
    Memo1: TMemo;
    Label1: TLabel;
    Button1: TButton;
    OpenDialog1: TOpenDialog;
    Memo2: TMemo;
    Button2: TButton;
    Memo3: TMemo;
    Label2: TLabel;
    Button3: TButton;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure Button3Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  frec: array[1..26] of real=(12.31,9.59,8.05,7.94,7.19,7.18,6.59,6.03,5.14,4.03,3.65,3.20,3.10,2.29,2.28,2.25,2.03,1.88,1.62,1.61,0.93,0.52,0.20,0.10,0.10,0.09);
  frec1: array[1..26] of real;
  frecsym: string = 'etaoinhsrdlumwcyfgpbvkxjqz';
  alpha: string = 'abcdefghijklmnopqrstuvwxyz';
  crack: string = 'abcdefghijklmnopqrstuvwxyz';
  count: integer;
implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var i,j:integer;
begin
  if OpenDialog1.Execute then
    begin
      Memo1.Lines.LoadFromFile(OpenDialog1.FileName);
      Memo1.Lines.Count;
      for i:=0 to Memo1.Lines.Count do
        for j:=1 to Length(Memo1.Lines[i]) do
          if (Memo1.Lines[i][j] in ['a'..'z']) then
            inc(count);
    end;
end;

procedure TForm1.Button2Click(Sender: TObject);
var i,j,k,n:integer;
    s:string;
    a:char;
    r:real;
begin
  memo2.Clear;
  for k:=1 to length(crack) do
    begin
      n:=0;
      a:=crack[k];
      for i:=0 to Memo1.Lines.Count do
        begin
          s:=Memo1.Lines[i];
          for j:=1 to length(s) do
            if a=s[j] then inc(n);
        end;
      frec1[k]:=(n/count)*100;
    end;

  for i:=1 to 25 do
    for j:=1 to 26-i do
      if frec1[j]<frec1[j+1] then
        begin
          r:=frec1[j];
          frec1[j]:=frec1[j+1];
          frec1[j+1]:=r;
          a:=crack[j];
          crack[j]:=crack[j+1];
          crack[j+1]:=a;
        end;
  for i:= 1 to 26 do
    Memo2.Lines.Add(FloatToStrf(frec[i],fffixed,4,2)+ #9 + frecsym[i] + ' - ' + crack[i] + #9+ FloatToStrf(frec1[i],fffixed,5,3))
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  Memo1.Clear;
  Memo2.Clear;
  Memo3.Clear;
end;

procedure TForm1.Button3Click(Sender: TObject);
var i,j,k:integer;
    s:string;
begin
  Memo3.Clear;
  for i:=0 to Memo1.Lines.Count do
    begin
      s:=Memo1.Lines[i];
      for j:=1 to Length(s) do
        if (s[j] in ['a'..'z']) then
          for k:=1 to 26 do
            if s[j]=crack[k] then
              begin
                s[j]:=frecsym[k];
                break;
              end;
      Memo3.Lines.Add(s);
    end;
end;

end.
