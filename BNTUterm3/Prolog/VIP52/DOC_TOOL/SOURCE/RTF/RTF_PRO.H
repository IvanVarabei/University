/*****************************************************************************

		Copyright (c) 1984 - 1999 Prolog Development Center A/S

 Project:  DOCCNV
 FileName: RTF_PRO.H
 Purpose: RTF Parser. The interface to PDC Prolog
 Written by: Oleg V. Erjomin
 Comments:
******************************************************************************/

/*
 *  Internal RTF tables (generated by PRO2C from RTF.PRE
 */
#ifndef __RTF_PRO_H__
#define __RTF_PRO_H__

#define VARFNO		0
#define CONSTFNO	1
#define LISTFNO		1
#define NILLFNO		2


typedef enum {
	rtf_tables_unbound=0,
	rtf_tables_rtf_tables
} RTF_TABLES_FNO;

typedef
  struct rtf_tables_struct {
	unsigned char fno;
	struct font_table_struct *Font_table;
	struct color_table_struct *Color_table;
  } RTF_TABLES;

typedef
  struct font_table_struct {
	unsigned char fno;
	struct font_tbl_record_struct *font_tbl_record;
	struct font_table_struct *next;
  } FONT_TABLE;

typedef enum {
	font_tbl_record_unbound=0,
	font_tbl_record_font_tbl_record
} FONT_TBL_RECORD_FNO;

typedef
  struct font_tbl_record_struct {
	unsigned char fno;
	INTEGER ftbl_Num;
	INTEGER ftbl_Charset;
	INTEGER ftbl_Prq;
	INTEGER ftbl_Family;
	STRING ftbl_FaceName;
  } FONT_TBL_RECORD;

typedef
  struct color_table_struct {
	unsigned char fno;
	struct color_tbl_record_struct *color_tbl_record;
	struct color_table_struct *next;
  } COLOR_TABLE;

typedef enum {
	color_tbl_record_unbound=0,
	color_tbl_record_color_tbl_record
} COLOR_TBL_RECORD_FNO;

typedef
  struct color_tbl_record_struct {
	unsigned char fno;
	INTEGER ctbl_R;
	INTEGER ctbl_G;
	INTEGER ctbl_B;
  } COLOR_TBL_RECORD;

typedef unsigned char PROFILE;

/*
 *  GLOBAL PREDICATES
 */

BOOL C_DECL rtf_default_cb (DOC *pDoc);
void rtfpage_term_0 (RTF_DOCPARSER_CALLBACK CBFunc);
BOOL CallPageCallback (void);

void rtf_SetBOOLMark (FLOW_ELEMENT_FNO Fno,BOOL Mark);
void rtf_SetEmptyMark (FLOW_ELEMENT_FNO Mark);
void rtf_SetEmptyAttMark (FLOW_ELEMENT_FNO Mark);
void WriteFontCode (void);
void rtf_Paragraph (void);
void MakeHyperLink (void);
void ClearHyperLink (void);
void rtf_StartTableRow (void);
void rtf_EndTableRow (void);
void rtf_EndTableCell (void);

#endif
